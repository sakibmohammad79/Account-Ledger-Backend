// This is your Prisma schema file

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}
// Chart of Accounts - Account Types
enum AccountType {
  ASSET
  LIABILITY
  EQUITY
  REVENUE
  EXPENSE
}

enum AccountCategory {
  // Assets
  CURRENT_ASSET
  FIXED_ASSET
  
  // Liabilities
  CURRENT_LIABILITY
  LONG_TERM_LIABILITY
  
  // Equity
  OWNER_EQUITY
  RETAINED_EARNINGS
  
  // Revenue
  OPERATING_REVENUE
  NON_OPERATING_REVENUE
  
  // Expenses
  OPERATING_EXPENSE
  NON_OPERATING_EXPENSE
}

enum TransactionType {
  SALES
  PURCHASE
  RECEIPT
  PAYMENT
  GENERAL
}

// Chart of Accounts Model
model Account {
  id          String        @id @default(uuid())
  code        String        @unique
  name        String
  type        AccountType
  category    AccountCategory
  description String?
  isActive    Boolean       @default(true)
  isDeleted    Boolean       @default(false)
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt
  
  entries     Entry[]
  @@map("account")
}

// Transaction (Header)
model Transaction {
  id              String          @id @default(uuid())
  transactionNo   String          @unique
  type            TransactionType
  date            DateTime
  description     String
  reference       String?
  notes           String?
  isDeleted       Boolean         @default(false)
  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @updatedAt
  
  entries         Entry[]
  @@map("transaction")
}

// Journal Entry (Line Items) - Double Entry System
model Entry {
  id              String      @id @default(uuid())
  transactionId   String
  accountId       String
  debit           Decimal     @default(0) @db.Decimal(15, 2)
  credit          Decimal     @default(0) @db.Decimal(15, 2)
  description     String?
  createdAt       DateTime    @default(now())
  updatedAt       DateTime    @updatedAt
  
  transaction     Transaction @relation(fields: [transactionId], references: [id], onDelete: Cascade)
  account         Account     @relation(fields: [accountId], references: [id])
  
  @@index([transactionId])
  @@index([accountId])
  @@map("entry")
}